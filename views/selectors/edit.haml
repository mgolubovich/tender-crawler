- @title = 'Edit selector'
%h1
%b Edit
selector for
%a{ href: "/cartridges/edit/#{@cartridge_id}" }
  %b= Cartridge.find(@cartridge_id).name
%h1
- if @selector.rules.empty?
  %a{ href: "/rules/new/#{@selector._id}"} Add rule
- else
  %b Rule
  was updated at
  %a{ :href => "/rules/#{@selector._id}/edit/#{@selector.rules.last._id}"} #{@selector.rules.last.updated_at.strftime("%d %B %Y (%R)")}

.container-fluid
  %form.form-horizontal{:action => "/cartridges/edit/#{@cartridge_id}/selector/#{@selector_id}", :method => "post"}
    %fieldset
      .form-group
        %label.col-md-4.control-label{:for => "selector_id"} ID
        .col-md-5
          %input.form-control.input-md{:id => "selector_id", :name => "selector_id", :type => "text", :size => 20, :value => @selector._id, readonly:true}

      .form-group
        %label.col-md-4.control-label{:for => "selector_value"} value_type
        .col-md-5
          %input.form-control.input-md{:id => "selector_value", :name => "selector_value", :type => "text", :size => 20, :value => @selector.value_type}

      .form-group
        %label.col-md-4.control-label{:for => "selector_link"} link_template
        .col-md-8
          %input.form-control.input-md{:id => "selector_link", :name => "selector_link", :type => "text", :size => 20, :value => @selector.link_template}

      .form-group
        %label.col-md-4.control-label{:for => "selector_xpath"} xpath
        .col-md-8
          %input.form-control.input-md{:id => "selector_xpath", :name => "selector_xpath", :type => "text", :size => 20, :value => @selector.xpath}

      .form-group
        %label.col-md-4.control-label{:for => "selector_css"} css
        .col-md-8
          %input.form-control.input-md{:id => "selector_css", :name => "selector_css", :type => "text", :size => 20, :value => @selector.css}

      .form-group
        %label.col-md-4.control-label{:for => "selector_attr"} attr
        .col-md-8
          %input.form-control.input-md{:id => "selector_attr", :name => "selector_attr", :type => "text", :size => 20, :value => @selector.attr}

      .form-group
        %label.col-md-4.control-label{:for => "selector_offset"} offset
        .col-md-8
          %input.form-control.input-md{:id => "selector_offset", :name => "selector_offset", :type => "text", :size => 20, :value => @selector.offset}

      .form-group
        %label.col-md-4.control-label{:for => "selector_regexp"} regexp
        .col-md-2
          %select.form-control{:id => "selector_mode_reg", :name => "selector_mode_reg"}
            %option{:value => "gsub", :selected => @selector.regexp["mode"] == 'gsub' ? true : false } gsub
            %option{:value => "match", :selected => @selector.regexp["mode"] == 'gsub' ? false : true } match
        .col-md-6
          %input.form-control.input-md{:id => "selector_pat_reg", :name => "selector_pat_reg", :type => "text", :size => 20, :value => @selector.regexp["pattern"]}

      .form-group
        %label.col-md-4.control-label{:for => "selector_date_format"} date_format
        .col-md-8
          %input.form-control.input-md{:id => "selector_date_format", :name => "selector_date_format", :type => "text", :size => 20, :value => @selector.date_format}

      .form-group
        %label.col-md-4.control-label{:for => "selector_js_code"} js_code
        .col-md-8
          %input.form-control.input-md{:id => "selector_js_code", :name => "selector_js_code", :type => "text", :size => 20, :value => @selector.js_code}

      .form-group
        %label.col-md-4.control-label{:for => "selector_to_type"} to_type
        .col-md-8
          %select.form-control{:id => "selector_to_type", :name => "selector_to_type"}
            %option{:value => :string, :selected => @selector.to_type == :string ? true : false} string
            %option{:value => :symbol, :selected => @selector.to_type == :symbol ? true : false} symbol
            %option{:value => :integer, :selected => @selector.to_type == :integer ? true : false} integer
            %option{:value => :float, :selected => @selector.to_type == :float ? true : false} float

      .form-group
        %label.col-md-4.control-label{:for => "selector_activity"} Активность
        .col-md-5
          %select.form-control{:id => "selector_activity", :name => "selector_activity"}
            %option{:value => "active", :selected => @selector.is_active ? true : false} Включен
            %option{:value => "blocked", :selected => @selector.is_active ? false : true } Выключен

      .form-group
        .col-xs-5.col-md-offset-3
          %input.btn.btn-primary.btn-lg{:name => "submint", :type => "submit", :value => "Сохранить"}
          %a.btn.btn-danger.btn-lg{:href => "/cartridges/edit/#{@cartridge_id}/selector/#{@selector_id}/destroy", :name => "delete", :type => "submit", :value => "Удалить", :method => "get"} Удалить

  %fieldset
    .form-group
      .col-md-12
        %label.control-label{:for => "entity_id"} Entity ID
        %input{id: "entity_id", type: "text", name: "entity_id"}
      .col-md-12
        %a{:href => '#', :"data-selector-id" => @selector._id, :"data-cartridge-id" => @cartridge_id, :id => "grappler-check"} Check


%script{:type => 'text/javascript', :src => "/javascripts/grappler-check.js" }




